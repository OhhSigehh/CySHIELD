<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Types of Cyber Threats</title>
  <link rel="shortcut icon" type="x-icon" href="logo.jpg" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: #0d1117;
      color: #c9d1d9;
      margin: 0; padding: 20px;
    }
  
    h1, h2, h4 { 
      font-family: 'Orbitron', sans-serif;
      color: #1f6feb;  
      margin-bottom: 1rem;
      text-shadow: 0 0 6px #0a58cb;
      text-align:center; 
    }
  
    .lesson-box {
      width: 80%;
      max-width: 900px;
      margin: 20px auto;
      background: #111;
      border: 1px solid #0a58ca;
      border-radius: 12px;
      padding: 20px;
      line-height: 1.6;
    }
  
    p {
      text-align: center;
    }
  
    b {
      color: #0a58cd;
    }
  
    .example {
      border-left: 3px double #30363d;
      padding-left: 10px;
      margin: 15px 0;
      font-style: italic;
    }
    
    ul{
      list-style: none;
      padding: 0;
      margin: 0;
    }
  
    ul li{
      padding: 13px 5px;
      border-top: 2px solid #30363d;
      border-bottom: 3px solid #30363d;
      border-radius: 5px;
      text-align: center;
      margin: 15px auto;
    }
  
    button {
      font-family: 'Orbitron', sans-serif;
      background: #1f6feb;
      display:block; margin:20px auto;
      padding:12px 20px;
      font-weight:bold; border:none;
      border-radius:8px; cursor:pointer;
      transition:0.3s;
    }
  
    button:hover { 
      background:#0a58ca;
      color:#fff;
      box-shadow:0 0 8px #0a58cb;
    }
  
    #popupMessage {
      display:none; 
      position:fixed; 
      top:0; left:0; 
      width:100%; 
      height:100%;
      background:rgba(0,0,0,0.85); 
      justify-content:center;
      align-items:center; 
      z-index:3000;
    }
  
    #popupMessage div {
      background:#161b22;
      border:1px solid #30363d; 
      border-radius:12px;
      padding:20px;
      width: 70%;
      max-width:400px; 
      text-align:center;
    }
  
    #popupMessage div h2{
      color:#1f6feb; 
      text-shadow:0 0 6px #0a58ca;
    }
  
    /* Quiz Modal */
    #quizModal {
      display: none;
      position: fixed; top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.85);
      justify-content: center;
      align-items: center;
      z-index: 2000;
    }
  
    #quizContent {
      background: #111;
      width: 75%; max-width: 900px;
      border: 1px solid #0a58ca;
      border-radius: 10px;
      padding: 20px;
      position: relative;
      max-height: 90%;
      overflow-y: auto;
    }
  
    #quizClose {
      position: absolute; 
      top: 10px; 
      right: 15px;
      font-size: 1.8rem; 
      cursor: pointer;
      color: #c9d1d9; 
      font-weight: bold;
    }
  
    .question { 
      color: #c9d1d9;
      margin-top: 20px; 
      font-weight:bold;
    }
  
    label { 
      display:block;
      margin:6px 0; 
      cursor:pointer; 
    }
  
    #result { 
      text-align:center;
      margin-top:20px;
      font-size:1.1rem; 
    }
  </style>
</head>
<body>
  <h1>Types of Cyber Threats</h1>
  <div class="lesson-box">
    <!-- Section 1 -->
    <div class="lesson-section" id="section1">
      <h2>What is a Cyber Threat?</h2>
      <p>
        A cyber threat is any <b>attempt to harm 
        or exploit a digital system</b>. Threats 
        can come from individuals, groups, or 
        even nation-states.
      </p>
      <h2>Key Topics</h2>
      <ul>
        <li>Malware</li>
        <li>Phishing</li>
        <li>Hacking</li>
      </ul>
      <button onclick="nextSection(1)">Next ➡</button>
    </div>   
    
    <!-- Section 2 -->
    <div class="lesson-section" id="section2" style="display:none;">
      <h2>Malware (<b>Malicious Software</b>)</h2>
      <p>
        Malware is software designed to harm devices or steal 
        information without the user’s knowledge. You can come in 
        contact with malwares when you <b>use/dowload cracked programs</b>,
        <b>open infected emails attachments</b>, or <b>clicking on 
        malicious links</b>. Here are some common types of Malware you 
        might be aware to:
      </p>
      <ul>
        <li><b>Virus</b><br>
        <p>
          Attaches to files/apps and spreads when 
          files are shared.
        </p></li>        
        <li><b>Worm</b><br>
        <p>
          Spreads automatically across networks.
        </p></li>
        <li><b>Trojan Horse</b><br>
        <p>
          Disguises itself as legitimate software.
        </p></li>
      </ul>
      <button onclick="nextSection(2)">Next ➡</button>
    </div>
    
    <!-- Section 3 -->
    <div class="lesson-section" id="section3" style="display:none;">
      <h2>Phishing</h2>
      <p>
        Phishing is a social engineering attack where attackers pretend 
        to be trusted organizations to trick users into revealing 
        sensitive information. Common targets of these attacks are
        Emails, Social Media Accounts, and Online Banking Credentials.        
      </p>      
      <ul>
        <h4 style="font-family: 'Inter', sans-serif;text-shadow:none;">Examples:</h4>
        <li>Fake emails from banks</li>
        <li>Messages claiming account problems</li>
        <li>Fake login pages that look real</li>
      </ul>
      <button onclick="nextSection(3)">Next ➡</button>
    </div>
    
    <!-- Section 4 -->
    <div class="lesson-section" id="section4" style="display:none;">
      <h2>Hacking</h2>
      <p>
        Hacking occurs when someone <b>gains access</b> to an 
        account or a system without permission of the owner.
        Here common methods of hacking:
      </p>
      <ul>
        <li>Guessing weak passwords</li>
        <li>Exploiting software vulnerabilities</li>
        <li>Using stolen credentials</li>
      </ul>
      <button onclick="nextSection(4)">Next ➡</button>
    </div>
    
    <!-- Section 5 -->
    <div class="lesson-section" id="section5" style="display:none;">
      <h2>Best Practices</h2>
      <ul>
        <li>Use strong, unique passwords and enable two-factor 
          authentication for all important accounts.</li>
        <li>Be cautious with emails, links, attachments, 
          and messages from unknown or suspicious sources.</li>
        <li>Download software only from trusted and 
          official sources.</li>
        <li>Stay aware of common cyber threats and 
          practice safe online behavior.</li>
        <li>Avoid oversharing personal information 
          online and adjust privacy settings regularly.</li>
      </ul>
      <button onclick="unlockQuiz()">Finish Lesson</button>
    </div>
    
    <button id="startQuizBtn" style="display:none;">Take the Quiz</button>
  </div>

  <!-- Custom Popup -->
  <div id="popupMessage">
    <div>
      <h2>Lesson Completed</h2>
      <p>Great job! You’ve completed the basics. Your first quiz is now unlocked.</p>
      <button onclick="closePopup()">OK</button>
    </div>
  </div>

  <!-- Quiz Modal -->
  <div id="quizModal">
    <div id="quizContent">
      <span id="quizClose">&times;</span>
      <h2>Lesson 1 Quiz</h2>
      <form id="quizForm"></form>
      <div id="result"></div>
    </div>
  </div>

  <!-- Section Unlock Script -->
  <script>
    function nextSection(current) {
      document.getElementById(`section${current}`).style.display = "none";
      document.getElementById(`section${current+1}`).style.display = "block";
    }

    function unlockQuiz() {
      document.getElementById("startQuizBtn").style.display = "block";
      document.getElementById("popupMessage").style.display = "flex"; // show custom popup  
    }

    function closePopup() {
      document.getElementById("popupMessage").style.display = "none";
    }
  </script>
  
  <!-- Firebase + Quiz Logic -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
    import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

    const firebaseConfig = { 
      apiKey: "AIzaSyDcy8AV_IMrphBOihSwT461C2_CmhHAZi4",
      authDomain: "cshield-41518.firebaseapp.com",
      projectId: "cshield-41518",
      storageBucket: "cshield-41518.firebasestorage.app",
      messagingSenderId: "1055312271929",
      appId: "1:1055312271929:web:c3415a674782ade5550be8"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // 5 sets of 5 questions
    const questionSets = [
      [
        { q: "Which of these is an example of phishing?", options: ["Funny YouTube video", "Email from your bank asking password"], correct: 1 },
        { q: "When using free public Wi-Fi, what should you do?", options: ["Login without worries", "Use a VPN or avoid sensitive logins"], correct: 1 },
        { q: "What’s a strong practice for passwords?", options: ["Use your birthday", "Use unique complex passwords"], correct: 1 },
        { q: "Which of the following is a type of malware?", options: ["Trojan Horse", "Google Chrome"], correct: 0 },
        { q: "Which is the safest action if you receive a suspicious link?", options: ["Click and see what happens", "Ignore or report the message"], correct: 1 }
      ],
      [
        { q: "Which one is malware?", options: ["Trojan Horse", "Notepad"], correct: 0 },
        { q: "Safe password example?", options: ["qwerty123", "M!ndStrong#2025"], correct: 1 },
        { q: "What’s the best response to a prize scam email?", options: ["Click the link to claim", "Ignore and report as phishing"], correct: 1 },
        { q: "Which connection is safest for online banking?", options: ["Public Wi-Fi", "Your secured home Wi-Fi"], correct: 1 },
        { q: "What’s the first step if your account is hacked?", options: ["Delete the account", "Change password + enable 2FA"], correct: 1 }
      ],
      [
        { q: "Which of these is a cyber threat?", options: ["Phishing emails", "Online games"], correct: 0 },
        { q: "What’s the safest way to download apps?", options: ["From official app stores", "From random websites"], correct: 0 },
        { q: "What is the purpose of 2FA?", options: ["Adds another security layer", "Makes login slower"], correct: 0 },
        { q: "Which one is suspicious?", options: ["Bank email with grammar errors", "Email from your teacher"], correct: 0 },
        { q: "What’s a secure browser behavior?", options: ["Look for HTTPS", "Ignore certificate warnings"], correct: 0 }
      ],
      [
        { q: "Strong passwords should include:", options: ["Only letters", "Mix of letters, numbers & symbols"], correct: 1 },
        { q: "Which device update behavior is safest?", options: ["Update immediately", "Delay for months"], correct: 0 },
        { q: "What should you do with unknown USB drives?", options: ["Plug in to check", "Avoid using/report it"], correct: 1 },
        { q: "Which website URL is safer?", options: ["http://example.com", "https://example.com"], correct: 1 },
        { q: "Best practice for school Wi-Fi logins?", options: ["Share password with friends", "Keep password private"], correct: 1 }
      ],
      [
        { q: "Which one is a safe online habit?", options: ["Sharing all personal info online", "Limiting info you share"], correct: 1 },
        { q: "If your browser warns of an unsafe site, you should:", options: ["Ignore and continue", "Leave immediately"], correct: 1 },
        { q: "What’s phishing’s main goal?", options: ["To entertain", "To steal your info"], correct: 1 },
        { q: "Which of these is an example of social engineering?", options: ["A stranger tricking you for your password", "Downloading from Google Play"], correct: 0 },
        { q: "Why is using unique passwords important?", options: ["One hack won’t affect other accounts", "It looks cool"], correct: 0 }
      ]
    ];

    // --- Helpers ---
    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    let currentSet = Math.floor(Math.random() * questionSets.length);

    function getRandomSet(excludeIndex) {
      let newIndex;
      do {
        newIndex = Math.floor(Math.random() * questionSets.length);
      } while (newIndex === excludeIndex);
      return newIndex;
    }

    function loadQuiz(setIndex) {
      const quizForm = document.getElementById("quizForm");
      quizForm.innerHTML = "";

      // shuffle questions
      const shuffledQuestions = shuffleArray([...questionSets[setIndex]]);

      shuffledQuestions.forEach((item, i) => {
        const div = document.createElement("div");
        div.classList.add("question");
        div.innerHTML = `${i+1}. ${item.q}`;

        // shuffle options
        const shuffledOptions = shuffleArray([...item.options]);
        shuffledOptions.forEach((opt) => {
          const label = document.createElement("label");
          const optionIndex = item.options.indexOf(opt); 
          label.innerHTML = `<input type="radio" name="q${i}" value="${optionIndex}"> ${opt}`;
          div.appendChild(label);
        });

        quizForm.appendChild(div);
      });

      const btn = document.createElement("button");
      btn.type = "button";
      btn.textContent = "Submit Quiz";
      btn.onclick = submitQuiz;
      quizForm.appendChild(btn);
    }

    window.submitQuiz = async function () {
      const questions = questionSets[currentSet];
      let score = 0;

      questions.forEach((item, i) => {
        const selected = document.querySelector(`input[name="q${i}"]:checked`);
        if (selected && parseInt(selected.value) === item.correct) {
          score++;
        }
      });

      if (score >= 3) {
        document.getElementById("result").innerHTML = 
          `✅ Great job! You passed with ${score}/5. Lesson completed.`;

        const user = auth.currentUser;
        if (user) {
          const ref = doc(db, "users", user.uid, "progress", "lessons");
          const snap = await getDoc(ref);
          let data = snap.exists() ? snap.data() : {};
          data.lesson1 = true;
          data.lesson2 = true;
          data.xp = (data.xp || 0) + 50;
          await setDoc(ref, data);
        }
        localStorage.setItem("lessonPassed", "Lesson 1 completed successfully!"); 
        setTimeout(()=> window.location.href="lessons.html", 2000);

      } else {
        document.getElementById("result").innerHTML = 
          `⚠ You scored ${score}/5. A new random question set will load...`;

        currentSet = getRandomSet(currentSet);

        setTimeout(() => {
          loadQuiz(currentSet);
          document.getElementById("result").innerHTML = "";
        }, 2500);
      }
    };
  
    function nextSection(current) {
      document.getElementById(`section${current}`).style.display = "none";
      document.getElementById(`section${current+1}`).style.display = "block";
    }
  
    function unlockQuiz() {
      document.getElementById("startQuizBtn").style.display = "block";
      alert("✅ You’ve completed the lesson content! Now you can take the quiz.");
    }

    // Modal control
    const quizModal = document.getElementById("quizModal");
    document.getElementById("startQuizBtn").onclick = () => {
      quizModal.style.display = "flex";
      currentSet = Math.floor(Math.random() * questionSets.length);
      loadQuiz(currentSet);
    };
    document.getElementById("quizClose").onclick = () => quizModal.style.display = "none";
    window.onclick = (e) => { if (e.target === quizModal) quizModal.style.display = "none"; };

    // Protect page
    onAuthStateChanged(auth, (user) => { if (!user) window.location.href="index.html"; });
  </script>
</body>
</html>
